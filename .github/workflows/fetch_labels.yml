name: "Fetch Labels"
on:
  workflow_dispatch

jobs:
  build:
    runs-on: ubuntu-latest
    steps:

      - uses: actions/checkout@v4
      - name: Obtener nombres de ramas de PRs abiertos con etiquetas especÃ­ficas
        id: fetch_labels
        uses: actions/github-script@v6
        with:
          script: |
            const prs = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'open',
              per_page: 100
            });
            const allowedLabels = ['Ready For QA', 'documentation', 'invalid'];
            const filtered = prs.data.filter(pr =>
              pr.labels.some(label => allowedLabels.includes(label.name))
            );
            const branchNames = filtered.map(pr => pr.head.ref).join(', ');
            core.info(`Branches fetched: ${branchNames}`);
            core.setOutput('branches', branchNames);

#const filtered = prs.data.filter(pr =>
  #pr.labels.some(label => label.name === 'Ready For QA')
   #                 );